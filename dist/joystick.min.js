function map(t,e,o,n,i){return(t-e)*(i-n)/(o-e)+n}function initJoystick(c){var t=document.getElementById(c.el),r=t.width,a=t.height,h=t.getContext("2d"),f=r/2,s=r/2,e=t.offsetTop,o=t.offsetLeft,n=window.scrollX,i=window.scrollY,u=o-n,d=e-i,l=c.innerCircleRadius||50,p=c.margin||20,P=c.outerCircleWidth||8,g=p-P/2,m=l+g;function C(){h.beginPath(),h.lineWidth=P,h.strokeStyle=c.outerCircleClr||"red",h.arc(r/2,a/2,r/2-p,0,2*Math.PI),h.stroke(),h.closePath(),h.beginPath(),h.fillStyle=c.innerCircleClr||"red",h.arc(f,s,l,0,2*Math.PI),h.fill(),h.closePath()}function w(t,e){e=d+a-g<(e=e<d+g?d+g:e)?d+r-g:e,f=map(t=u+r-g<(t=t<u+g?u+g:t)?u+r-g:t,u,u+r,m,r-m),s=map(e,d,d+a,m,a-m),h.clearRect(0,0,r,a),C();var o,n,i=Math.floor(map(f,m,r-m,0,100)),l=Math.floor(map(s,m,a-m,0,100));c.showPos&&(o=i+"%",n=l+"%",h.beginPath(),h.font="10px Poppins",h.fillText("x: "+o+", y: "+n,5,12),h.fill(),h.closePath()),c.posChnage(i,l)}C(),t.ontouchmove=function(t){w(t.touches[0].clientX,t.touches[0].clientY)},t.ontouchend=function(){c.autoCenter&&w(u+r/2,d+a/2)}}